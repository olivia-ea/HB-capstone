{% extends 'base.html' %}
{% block content %}

<div>Input an activity to generate a playlist!</div>

<br>
 
<form id="activity-form" autocomplete="off" >
    Activity name: <input type="text" id="activity_query">
    <br>
    Playlist name: <input type="text" id="playlist_name">
    <input type="submit" value="Submit" id='search-button'>
</form>
<script src="../static/autocomplete.js"></script>

<br>
<br>

<div id="div-playlist"></div>

<div id="prev-playlist-table"></div>

<!-- *******************Create jsGRID Table********************** -->
<script>

  $.get('/activity-page.json', (results) => {
    console.log(results);
    $("#prev-playlist-table").jsGrid({
        width: "100%",
        height: "400px",
        // inserting: true,
        // editing: true,
        sorting: true,
        selecting: true,
        // paging: true,

        data: results,

        fields: [
            { name: "title", title: "Previous Playlists", type: "text", width: 150, validate: "required" }
            // { type: "control" }
        ]
      });
  });
</script>
<!-- *****************AJAX Response to SUBMIT***********************-->
<script>

  $('#activity-form').submit(function( event ) {
    event.preventDefault();
 
    const formData = {
      activity_query: $('#activity_query').val(),
      playlist_name: $('#playlist_name').val()
      };

    $.post('/activity-page-cont', formData, (results) => {
      $('#div-playlist').html(`<iframe id="view-playlist"  data src="${results.playlist}" width="500" height="580" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>`);
    });
 
    $("#prev-playlist-table").jsGrid("insertItem", ({'title': formData.playlist_name})).done(function() {
    });

  });

</script>
<!-- ***********AJAX Response to PREV PLAYLIST*******************-->
<script>
  $('#prev-playlist-table').onclick(function( event ) {
    event.preventDefault();

    // onOptionChanging or onclick

  const formData = {
    playlist_name: $('#playlist_name').val()
    };

  $.post('/activity-page-cont', formData, (results) => {
      $('#div-playlist').html(`<iframe id="view-playlist"  data src="${results.playlist}" width="500" height="580" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>`);
    });
  
</script>>


<br>
<br>
<br>
<div>  
    <button id='logout-user' onclick="location.href = '/logout'">logout</button>
</div>

{% endblock %}
